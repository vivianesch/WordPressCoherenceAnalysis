---
title: "WordPress Agents Exploratory Analysis - Part II"
author: "Viviane Schneider"
date: "07/29/2019"
output: html_document
---
**Type of Analysis:** Descriptive analysis - Bivariate description

**Source:** Data come from WordPress Report Trac System.
[URL Source](https://core.trac.wordpress.org/query?status=accepted&status=assigned&status=new&status=reopened&status=reviewing&col=id&col=summary&col=status&col=owner&col=type&col=priority&col=milestone&col=component&col=version&col=severity&col=resolution&col=time&col=changetime&col=focuses&col=reporter&col=keywords&order=priority)
**Dataframe:** [GitHub Repository](https://raw.githubusercontent.com/vivianesch/CoherenceAnalysisWordPress/master/TicketW.csv)

**Date collection:** 04/07/2019.

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
```

**1. EXPLORATORY ANALYSIS -BIVARIABLE ANALYSIS** 

```{r}
library(readr)
install.packages("dplyr")
library(dplyr)
library(plotly)
library(markdown)
library(ggplot2)
library(lattice)
library(tidyr)

#READ DATA
TicketW <- read_csv('~/PhD Analysis/1. PhD escriptive exploratory analysis/TicketW.csv')
View(TicketW) # Read 
glimpse(TicketW)

```

**1 REPORTERS AND KEYWORDS ANALYSIS:** Reporters are WordPress Community members who find and report a problem from WP Platform, into a Ticket.

**Goal:** Identify the most frequent used to each report member groups (actives, medians, and aliens).

```{r}

#Bring the variables from the first univariable analysis
Reporter<-table(TicketW$Reporter) 
Reporter<-as.data.frame(as.table(Reporter))
ActiveReporters = filter(Reporter,Freq>10)
MedianReporters = filter(Reporter,Freq<10 & Freq>4)
LessReporters = filter(Reporter,Freq<4)

#1.1 Analyse Keywords used for Active reporters
Reporter_Keywords<- TicketW %>% select(Reporter,Keywords) #Table of Reporters and Keywords
summary(Reporter_Keywords)
dim(Reporter_Keywords)
glimpse(Reporter_Keywords)

nrow(ActiveReporters)#Quantity of Active Reporters
AR<-ActiveReporters[1:34,1:1] #Select array of active reporters names to filter 
AR<-as.character(AR) #Transform filter into caracter

ActiveR_Key = subset(Reporter_Keywords, Reporter_Keywords$Reporter %in% AR) 
ActiveR_Key<-table(ActiveR_Key$Keywords,ActiveR_Key$Reporter)
dim(ActiveR_Key)# Find dimensions
ActiveR_Sum_Keys<-rowSums(ActiveR_Key[1:229,1:34])# Sum of Keywords
ActiveR_Sum_Keys<-as.data.frame(as.table(ActiveR_Sum_Keys)) # Transform to a data frame
ActiveR_Sum_Keys<- ActiveR_Sum_Keys[order(ActiveR_Sum_Keys$Freq, decreasing = TRUE),] #Ranking Keywords

Most_Key_AR = filter(ActiveR_Sum_Keys,ActiveR_Sum_Keys$Freq>10)
Most_Key_AR# Filter the keywords with more than 10 frequency

#1.2 Analyse Keywords used for Median reporters
nr<-nrow(MedianReporters)#Quantity of Median Reporters
MR<-MedianReporters[1:nr,1:1] #Select array of median reporters names to filter 
MR<-as.character(MR) #Transform filter into caracter

MedianR_Key = subset(Reporter_Keywords, Reporter_Keywords$Reporter %in% MR) 
MedianR_Key<-table(MedianR_Key$Keywords,MedianR_Key$Reporter)
dim(MedianR_Key)# Find dimensions
MedianR_Sum_Keys<-rowSums(MedianR_Key[1:76,1:36])# Sum of Keywords
MedianR_Sum_Keys<-as.data.frame(as.table(MedianR_Sum_Keys)) # Transform to a data frame
MedianR_Sum_Keys<- MedianR_Sum_Keys[order(MedianR_Sum_Keys$Freq, decreasing = TRUE),] #Ranking Keywords

Most_Key_MR = filter(MedianR_Sum_Keys,MedianR_Sum_Keys$Freq>2)
Most_Key_MR# Filter the keywords with more than 10 frequency

#1.3 Analyse Keywords used for Alien reporters
nr<-nrow(LessReporters)#Quantity of Alien Reporters
LR<-LessReporters[1:nr,1:1] #Select array of median reporters names to filter 
LR<-as.character(LR) #Transform filter into caracter

LessR_Key = subset(Reporter_Keywords, Reporter_Keywords$Reporter %in% LR) 
LessR_Key<-table(LessR_Key$Keywords,LessR_Key$Reporter)
dim(MedianR_Key)# Find dimensions
LessR_Sum_Keys<-rowSums(LessR_Key[1:76,1:36])# Sum of Keywords
LessR_Sum_Keys<-as.data.frame(as.table(LessR_Sum_Keys)) # Transform to a data frame
LessR_Sum_Keys<- LessR_Sum_Keys[order(LessR_Sum_Keys$Freq, decreasing = TRUE),] #Ranking Keywords

Most_Key_LR = filter(LessR_Sum_Keys,LessR_Sum_Keys$Freq>=1)
Most_Key_LR# Filter the keywords with more than 10 frequency

par(mfrow=c(1,3))
barplot(Most_Key_AR$Freq, las = 2, names.arg = Most_Key_AR$Var1,
        col ="lightblue", main ="Freq. words of Active Reporters",
        ylab = "Word frequencies")
barplot(Most_Key_MR$Freq, las = 2, names.arg = Most_Key_MR$Var1,
        col ="lightgreen", main ="Freq. words of Median Reporters",
        ylab = "Word frequencies")
barplot(Most_Key_LR$Freq, las = 2, names.arg = Most_Key_LR$Var1,
        col ="lightgreen", main ="Freq. words of Median Reporters",
        ylab = "Word frequencies")

```




